{% extends "dashboard/base_admin.html" %}

{% block title %}Sin conexi贸n{% endblock %}
{% block top_title %} Sin conexi贸n{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="mb-2">Est谩s sin internet</h5>

    <p class="text-muted mb-3">
      La app no pudo cargar esta p谩gina. Cuando vuelvas a tener conexi贸n, presiona <b>Reintentar</b>.
    </p>

    <div class="d-flex align-items-center gap-2 mb-3">
      <span id="net-badge" class="badge bg-secondary">Comprobando...</span>
      <small class="text-muted">Estado de red</small>
    </div>

    <div class="d-flex flex-wrap gap-2">
      <button id="btn-retry" class="btn btn-primary" type="button"> Reintentar</button>
      <a class="btn btn-outline-secondary" href="/dashboard/"> Ir al inicio</a>
    </div>

    <hr class="my-3">

    <details class="text-muted">
      <summary>驴Qu茅 puedo hacer mientras estoy offline?</summary>
      <ul class="mt-2 mb-0">
        <li>Revisa si tu Wi-Fi o datos m贸viles est谩n activos.</li>
        <li>Si ya volvi贸 el internet, presiona <b>Reintentar</b>.</li>
        <li>Si el problema persiste, cierra y abre la app.</li>
      </ul>
    </details>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  (function () {
    const badge = document.getElementById("net-badge");
    const btnRetry = document.getElementById("btn-retry");

    function setStatus() {
      const online = navigator.onLine;
      if (badge) {
        badge.textContent = online ? "Online" : "Offline";
        badge.className = "badge " + (online ? "bg-success" : "bg-danger");
      }
      if (btnRetry) {
        btnRetry.disabled = !online;
        btnRetry.title = online ? "" : "Sin conexi贸n: espera a tener internet";
      }
    }

    if (btnRetry) btnRetry.addEventListener("click", () => window.location.reload());
    setStatus();
    window.addEventListener("online", setStatus);
    window.addEventListener("offline", setStatus);
  })();
</script>
{% endblock %}