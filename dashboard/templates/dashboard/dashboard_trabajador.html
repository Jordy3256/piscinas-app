{% extends "dashboard/base_app.html" %}

{% block title %}Mis mantenimientos{% endblock %}
{% block top_title %}ğŸ§‘â€ğŸ”§ Mis mantenimientos{% endblock %}

{% block content %}

<style>
  .card-tap { cursor: pointer; }
  .badge-state { font-weight: 600; }
</style>

<div class="text-muted small mb-3">Hoy: {{ hoy }}</div>

<!-- Resumen rÃ¡pido -->
<div class="row g-2 mb-3">
  <div class="col-6">
    <div class="card shadow-sm">
      <div class="card-body py-3">
        <div class="text-muted small">Hoy</div>
        <div class="fs-4 fw-bold">{{ mantenimientos_hoy|length }}</div>
      </div>
    </div>
  </div>
  <div class="col-6">
    <div class="card shadow-sm">
      <div class="card-body py-3">
        <div class="text-muted small">PrÃ³ximos</div>
        <div class="fs-4 fw-bold">{{ mantenimientos_proximos|length }}</div>
      </div>
    </div>
  </div>
</div>

<!-- SecciÃ³n HOY -->
<div class="d-flex align-items-center justify-content-between mb-2">
  <div class="fw-bold">ğŸ“Œ Hoy</div>
  <span class="text-muted small">Toca para abrir</span>
</div>

{% if mantenimientos_hoy %}
  <div class="vstack gap-2 mb-4">
    {% for m in mantenimientos_hoy %}
    <a class="text-decoration-none" href="/dashboard/mantenimientos/{{ m.id }}/">
      <div class="card shadow-sm card-tap">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <div class="fw-bold">{{ m.cliente }}</div>
              <div class="text-muted small">ğŸ“… {{ m.fecha }}</div>
            </div>

            {% if m.estado == "realizado" %}
              <span class="badge text-bg-success badge-state">Realizado</span>
            {% else %}
              <span class="badge text-bg-warning badge-state">Pendiente</span>
            {% endif %}
          </div>

          <div class="mt-2 text-muted small">
            Contrato: {{ m.contrato }}
          </div>

          <div class="mt-3">
            <span class="btn btn-primary btn-sm">Abrir detalle</span>
          </div>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
{% else %}
  <div class="card shadow-sm mb-4">
    <div class="card-body text-muted">
      No tienes mantenimientos programados para hoy.
    </div>
  </div>
{% endif %}

<!-- SecciÃ³n PRÃ“XIMOS -->
<div class="d-flex align-items-center justify-content-between mb-2">
  <div class="fw-bold">ğŸ—“ PrÃ³ximos</div>
  <span class="text-muted small">MÃ¡x 20</span>
</div>

{% if mantenimientos_proximos %}
  <div class="vstack gap-2">
    {% for m in mantenimientos_proximos %}
    <a class="text-decoration-none" href="/dashboard/mantenimientos/{{ m.id }}/">
      <div class="card shadow-sm card-tap">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <div class="fw-bold">{{ m.cliente }}</div>
              <div class="text-muted small">ğŸ“… {{ m.fecha }}</div>
            </div>

            {% if m.estado == "realizado" %}
              <span class="badge text-bg-success badge-state">Realizado</span>
            {% else %}
              <span class="badge text-bg-warning badge-state">Pendiente</span>
            {% endif %}
          </div>

          <div class="mt-2 text-muted small">
            Contrato: {{ m.contrato }}
          </div>

          <div class="mt-3">
            <span class="btn btn-outline-primary btn-sm">Ver detalle</span>
          </div>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>
{% else %}
  <div class="card shadow-sm">
    <div class="card-body text-muted">
      No hay mantenimientos prÃ³ximos asignados.
    </div>
  </div>
{% endif %}

{% endblock %}
